<template>
    <aside
        class="oil-sidebar"
        :style="{ width: !opened_sidebar.value ? '72px' : '256px' }"
    >
        <div
            class="oil-sidebar__logo"
            :style="{
                clipPath: !opened_sidebar.value ? 'inset(0 115px 0 0)' : 'none',
            }"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="142"
                height="24"
                viewBox="0 0 142 24"
                fill="none"
            >
                <g clip-path="url(#clip0_114_59452)">
                    <path
                        d="M17.0287 18.3395C15.6478 19.4363 13.9004 20.0914 12 20.0914C7.53122 20.0914 3.90857 16.4688 3.90857 12C3.90857 7.53122 7.53123 3.90856 12 3.90856C13.8445 3.90856 15.5448 4.52572 16.9058 5.56481C17.5963 4.44499 18.4657 3.44721 19.4742 2.61131C17.4238 0.976852 14.826 0 12 0C5.37259 -1.62846e-06 1.62846e-06 5.37258 0 12C0 18.6274 5.37258 24 12 24C14.9088 24 17.5759 22.965 19.6531 21.2433C18.6282 20.4263 17.7402 19.4451 17.0287 18.3395Z"
                        fill="#262E38"
                    />
                    <path
                        d="M19.3585 15.3698C19.9492 16.6733 20.8583 17.8017 21.9865 18.6558C23.2585 16.7511 24 14.4622 24 12C24 9.45516 23.2078 7.09534 21.8566 5.15368C20.7461 6.02843 19.8582 7.17335 19.2922 8.48934C19.8044 9.55123 20.0914 10.7421 20.0914 12C20.0914 13.2026 19.8291 14.3439 19.3585 15.3698Z"
                        fill="#03AEE2"
                    />
                    <path
                        d="M28.9946 0.648647H33.2108V23.3514H28.9946V0.648647Z"
                        fill="#262E38"
                    />
                    <path
                        d="M39.0271 0.648647H43.2433V19.7838H55.1136V23.3514H39.0271V0.648647Z"
                        fill="#262E38"
                    />
                    <path
                        d="M68.2143 23.6757C65.9224 23.6757 63.8467 23.1784 61.9873 22.1838C60.1494 21.1676 58.7008 19.773 57.6413 18C56.6035 16.227 56.0845 14.227 56.0845 12C56.0845 9.77297 56.6143 7.77297 57.6737 6C58.7332 4.22703 60.1818 2.84324 62.0197 1.84865C63.8791 0.832431 65.9548 0.324323 68.2467 0.324323C70.1062 0.324323 71.8035 0.648648 73.3386 1.2973C74.8737 1.94595 76.171 2.88648 77.2305 4.11892L74.5062 6.68108C72.8629 4.90811 70.8413 4.02162 68.4413 4.02162C66.8846 4.02162 65.49 4.36757 64.2575 5.05946C63.0251 5.72973 62.0629 6.67027 61.371 7.88108C60.6791 9.09189 60.3332 10.4649 60.3332 12C60.3332 13.5351 60.6791 14.9081 61.371 16.1189C62.0629 17.3297 63.0251 18.2811 64.2575 18.973C65.49 19.6432 66.8846 19.9784 68.4413 19.9784C70.8413 19.9784 72.8629 19.0811 74.5062 17.2865L77.2305 19.8811C76.171 21.1135 74.8629 22.0541 73.3062 22.7027C71.771 23.3514 70.0737 23.6757 68.2143 23.6757Z"
                        fill="#262E38"
                    />
                    <path
                        d="M95.1953 18.0973H83.8439L81.6061 23.3514H77.2601L87.4764 0.648647H91.6277L101.876 23.3514H97.4655L95.1953 18.0973ZM93.8007 14.7892L89.5196 4.86486L85.271 14.7892H93.8007Z"
                        fill="#262E38"
                    />
                    <path
                        d="M111.477 23.6757C109.726 23.6757 108.028 23.427 106.385 22.9297C104.764 22.4324 103.477 21.773 102.526 20.9513L103.985 17.6757C104.915 18.4108 106.05 19.0162 107.391 19.4919C108.753 19.9459 110.115 20.173 111.477 20.173C113.164 20.173 114.418 19.9027 115.239 19.3622C116.083 18.8216 116.504 18.1081 116.504 17.2216C116.504 16.573 116.266 16.0432 115.791 15.6324C115.337 15.2 114.753 14.8649 114.039 14.627C113.326 14.3892 112.353 14.1189 111.12 13.8162C109.391 13.4054 107.985 12.9946 106.904 12.5838C105.845 12.173 104.926 11.5351 104.147 10.6703C103.391 9.78378 103.012 8.59459 103.012 7.1027C103.012 5.84865 103.347 4.71351 104.018 3.6973C104.71 2.65946 105.737 1.83784 107.099 1.23243C108.483 0.627026 110.169 0.324323 112.158 0.324323C113.542 0.324323 114.904 0.497296 116.245 0.843243C117.585 1.18919 118.742 1.68649 119.715 2.33513L118.385 5.61081C117.391 5.02703 116.353 4.58378 115.272 4.28108C114.191 3.97838 113.142 3.82703 112.126 3.82703C110.461 3.82703 109.218 4.10811 108.396 4.67027C107.596 5.23243 107.196 5.97838 107.196 6.90811C107.196 7.55676 107.423 8.08648 107.877 8.4973C108.353 8.90811 108.947 9.23243 109.661 9.47027C110.374 9.70811 111.347 9.97838 112.58 10.2811C114.266 10.6703 115.65 11.0811 116.731 11.5135C117.812 11.9243 118.731 12.5622 119.488 13.427C120.266 14.2919 120.656 15.4595 120.656 16.9297C120.656 18.1838 120.31 19.3189 119.618 20.3351C118.947 21.3514 117.92 22.1622 116.537 22.7676C115.153 23.373 113.466 23.6757 111.477 23.6757Z"
                        fill="#262E38"
                    />
                    <path
                        d="M141.539 19.8162V23.3514H124.512V0.648647H141.085V4.18378H128.728V10.0865H139.69V13.5568H128.728V19.8162H141.539Z"
                        fill="#262E38"
                    />
                </g>
                <defs>
                    <clipPath id="clip0_114_59452">
                        <rect width="141.552" height="24" fill="white" />
                    </clipPath>
                </defs>
            </svg>
        </div>
        <div class="oil-sidebar__expand" @click="openSidebar">
            <svg
                :class="{ '_active-chevron': opened_sidebar.value }"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
            >
                <path
                    d="M9 18L15 12L9 6"
                    stroke="#808E9D"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>
        </div>
        <div class="oil-sidebar__page">
            <ul class="oil-sidebar__page__list">
                <li class="oil-sidebar__page__list__elem"
                    v-for="(menu, idx) in roleMenu"
                    :key="idx"
                    :class="{ '_active-page': menu.link === $route.path }"
                >
                    <LinkCmp
                        :opened_sidebar="opened_sidebar.value"
                        :link_name="menu.name"
                        :link_active="menu.link === $route.path"
                        :to="menu.link"
                        @click="navigate(menu.link)"
                    >
                        <i v-html="menu.icon"></i>
                    </LinkCmp>
                </li>
            </ul>
            <ul class="oil-sidebar__page__list">
                <li
                    class="oil-sidebar__page__list__elem"
                    v-for="(menu, idx) in menu_bar.slice(3)"
                    :key="idx"
                >
                    <LinkCmp
                        :opened_sidebar="opened_sidebar.value"
                        :link_name="menu.name"
                        :link_active="router.hasRoute(menu.link)"
                        @click="navigate(menu.link)"
                    >
                        <i v-html="menu.icon"></i>
                    </LinkCmp>
                </li>
            </ul>
        </div>
    </aside>
</template>
<script lang="ts">
import {defineComponent, computed, onMounted} from 'vue';
import { useRouter } from 'vue-router';
import { useUserRoleStore } from '~/src/stores/storeRole';

export default defineComponent({
    setup() {
        const router = useRouter()
        const user_role_store = useUserRoleStore()

        const opened_sidebar = reactive({
            value: false
        })

        const menu_bar = [
            {
                link: '/course-page',
                name: 'Курсы', //мои курсы для автора
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M16.6673 15.8337V13.3337H5.83398C4.45327 13.3337 3.33398 14.4529 3.33398 15.8337M7.33398 18.3337H14.0007C14.9341 18.3337 15.4008 18.3337 15.7573 18.152C16.0709 17.9922 16.3259 17.7372 16.4857 17.4236C16.6673 17.0671 16.6673 16.6004 16.6673 15.667V4.33366C16.6673 3.40024 16.6673 2.93353 16.4857 2.57701C16.3259 2.2634 16.0709 2.00844 15.7573 1.84865C15.4008 1.66699 14.9341 1.66699 14.0007 1.66699H7.33398C5.93385 1.66699 5.23379 1.66699 4.69901 1.93948C4.2286 2.17916 3.84615 2.56161 3.60647 3.03202C3.33398 3.5668 3.33398 4.26686 3.33398 5.66699V14.3337C3.33398 15.7338 3.33398 16.4339 3.60647 16.9686C3.84615 17.439 4.2286 17.8215 4.69901 18.0612C5.23379 18.3337 5.93385 18.3337 7.33398 18.3337Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/></svg>'
            },
            {
                link: '/direction-page',
                name: 'Направления',
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M7 2.5H3.83333C3.36662 2.5 3.13327 2.5 2.95501 2.59083C2.79821 2.67072 2.67072 2.79821 2.59083 2.95501C2.5 3.13327 2.5 3.36662 2.5 3.83333V7C2.5 7.46671 2.5 7.70007 2.59083 7.87833C2.67072 8.03513 2.79821 8.16261 2.95501 8.24251C3.13327 8.33333 3.36662 8.33333 3.83333 8.33333H7C7.46671 8.33333 7.70007 8.33333 7.87833 8.24251C8.03513 8.16261 8.16261 8.03513 8.24251 7.87833C8.33333 7.70007 8.33333 7.46671 8.33333 7V3.83333C8.33333 3.36662 8.33333 3.13327 8.24251 2.95501C8.16261 2.79821 8.03513 2.67072 7.87833 2.59083C7.70007 2.5 7.46671 2.5 7 2.5Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/><path d="M16.1667 2.5H13C12.5333 2.5 12.2999 2.5 12.1217 2.59083C11.9649 2.67072 11.8374 2.79821 11.7575 2.95501C11.6667 3.13327 11.6667 3.36662 11.6667 3.83333V7C11.6667 7.46671 11.6667 7.70007 11.7575 7.87833C11.8374 8.03513 11.9649 8.16261 12.1217 8.24251C12.2999 8.33333 12.5333 8.33333 13 8.33333H16.1667C16.6334 8.33333 16.8667 8.33333 17.045 8.24251C17.2018 8.16261 17.3293 8.03513 17.4092 7.87833C17.5 7.70007 17.5 7.46671 17.5 7V3.83333C17.5 3.36662 17.5 3.13327 17.4092 2.95501C17.3293 2.79821 17.2018 2.67072 17.045 2.59083C16.8667 2.5 16.6334 2.5 16.1667 2.5Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/><path d="M16.1667 11.6667H13C12.5333 11.6667 12.2999 11.6667 12.1217 11.7575C11.9649 11.8374 11.8374 11.9649 11.7575 12.1217C11.6667 12.2999 11.6667 12.5333 11.6667 13V16.1667C11.6667 16.6334 11.6667 16.8667 11.7575 17.045C11.8374 17.2018 11.9649 17.3293 12.1217 17.4092C12.2999 17.5 12.5333 17.5 13 17.5H16.1667C16.6334 17.5 16.8667 17.5 17.045 17.4092C17.2018 17.3293 17.3293 17.2018 17.4092 17.045C17.5 16.8667 17.5 16.6334 17.5 16.1667V13C17.5 12.5333 17.5 12.2999 17.4092 12.1217C17.3293 11.9649 17.2018 11.8374 17.045 11.7575C16.8667 11.6667 16.6334 11.6667 16.1667 11.6667Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/><path d="M7 11.6667H3.83333C3.36662 11.6667 3.13327 11.6667 2.95501 11.7575C2.79821 11.8374 2.67072 11.9649 2.59083 12.1217C2.5 12.2999 2.5 12.5333 2.5 13V16.1667C2.5 16.6334 2.5 16.8667 2.59083 17.045C2.67072 17.2018 2.79821 17.3293 2.95501 17.4092C3.13327 17.5 3.36662 17.5 3.83333 17.5H7C7.46671 17.5 7.70007 17.5 7.87833 17.4092C8.03513 17.3293 8.16261 17.2018 8.24251 17.045C8.33333 16.8667 8.33333 16.6334 8.33333 16.1667V13C8.33333 12.5333 8.33333 12.2999 8.24251 12.1217C8.16261 11.9649 8.03513 11.8374 7.87833 11.7575C7.70007 11.6667 7.46671 11.6667 7 11.6667Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/></svg>'
            },
            {
                link: '/tags-page',
                name: 'Метки',
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M14.8333 8.33333C15.7668 8.33333 16.2335 8.33333 16.59 8.15168C16.9036 7.99189 17.1586 7.73692 17.3183 7.42332C17.5 7.0668 17.5 6.60009 17.5 5.66667V5.16667C17.5 4.23325 17.5 3.76654 17.3183 3.41002C17.1586 3.09641 16.9036 2.84145 16.59 2.68166C16.2335 2.5 15.7668 2.5 14.8333 2.5L5.16667 2.5C4.23325 2.5 3.76654 2.5 3.41002 2.68166C3.09641 2.84144 2.84144 3.09641 2.68166 3.41002C2.5 3.76654 2.5 4.23325 2.5 5.16667L2.5 5.66667C2.5 6.60009 2.5 7.0668 2.68166 7.42332C2.84144 7.73692 3.09641 7.99189 3.41002 8.15168C3.76654 8.33333 4.23325 8.33333 5.16667 8.33333L14.8333 8.33333Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/><path d="M14.8333 17.5C15.7668 17.5 16.2335 17.5 16.59 17.3183C16.9036 17.1586 17.1586 16.9036 17.3183 16.59C17.5 16.2335 17.5 15.7668 17.5 14.8333V14.3333C17.5 13.3999 17.5 12.9332 17.3183 12.5767C17.1586 12.2631 16.9036 12.0081 16.59 11.8483C16.2335 11.6667 15.7668 11.6667 14.8333 11.6667L5.16667 11.6667C4.23325 11.6667 3.76654 11.6667 3.41002 11.8483C3.09641 12.0081 2.84144 12.2631 2.68166 12.5767C2.5 12.9332 2.5 13.3999 2.5 14.3333L2.5 14.8333C2.5 15.7668 2.5 16.2335 2.68166 16.59C2.84144 16.9036 3.09641 17.1586 3.41002 17.3183C3.76654 17.5 4.23325 17.5 5.16667 17.5H14.8333Z" stroke="#808E9D" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/></svg>'
            },
            {
                link: '#',
                name: 'Выход',
                icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M14.9993 6.66667L18.3327 10M18.3327 10L14.9993 13.3333M18.3327 10H7.49935M12.4993 3.50337C11.4371 2.86523 10.2037 2.5 8.88824 2.5C4.89951 2.5 1.66602 5.85786 1.66602 10C1.66602 14.1421 4.89951 17.5 8.88824 17.5C10.2037 17.5 11.4371 17.1348 12.4993 16.4966" stroke="#808E9D" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/></svg>'
            },
        ]

        const roleMenu = computed(() => {            
            if (user_role_store.role === 'Admin') {
                console.log(menu_bar);

                return menu_bar.slice(0, 3);
            } else if (user_role_store.role === 'Author') {
                console.log(menu_bar);

                return menu_bar.slice(0, 1);
            }

            return menu_bar 
        });

        const navigate = (url: string) => {
            router.push(url);
        }

        const openSidebar = () => {
            opened_sidebar.value = !opened_sidebar.value
        }

        return {
            menu_bar,
            navigate,
            opened_sidebar,
            openSidebar,
            user_role_store,
            roleMenu
        }
    }
})
</script>
<style scoped lang="sass">
.oil-sidebar
    padding: rem(24) rem(26)

    position: fixed
    z-index: 10
    gap: rem(24)
    @include flex_column()
    transition: width .3s
    height: 100vh
    overflow: hidden
    box-shadow: 0px 4px 6px -4px rgba(24, 39, 75, 0.12), 0px 8px 8px -4px rgba(24, 39, 75, 0.08)
    background-color: $basic-white
    &__page
        height: 100%
        @include flex_center_spacing()
        flex-direction: column
        margin: 0 rem(-26)
        &__list
            @include flex_column()
            gap: rem(4)
            width: 100%
            &__elem
                &:has(>a.router-link-active)
                    background-color: $basic_light_blue
                    border-left: 2px solid $basic_primary

                    >a.router-link-active *
                        color: $basic_primary

                    i *
                        stroke: $basic_primary



    &__logo
        @include flex_start()
        width: fit-content

    &__expand
        @include flex_start()
        cursor: pointer
        svg
            transition: transform .2s linear

        ._active-chevron
            transform: rotate(180deg)
</style>
